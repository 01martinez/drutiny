title: "Untrusted Roles with administrative permissions"
name: Drupal-8:UntrustedRoles
class: \Drutiny\Plugin\Drupal8\Audit\UntrustedRoles
tags:
  - Best Practice
  - Security
description: |
  Make sure administrative permissions has not been assigned to untrusted roles.
remediation: |
  Remove the following permissions from the roles. Also, consider reassigning the
  permissions to a new, trusted role or to an existing, trusted role.
  
  Untrusted Role | Administrative Permission(s)
      --- | ---
      {{# rows }}
        {{role}} | {{permissions}}
      {{/ rows }}

success: |
  Untrusted roles do not have administrative permissions.

failure: |
  Administrative permissions are assigned to untrusted roles.

parameters:
  untrusted_roles:
    default: ["anonymous","authenticated"]
    type: array
    description: |
      The untrusted Roles.